# Reference: https://github.com/i3/i3/blob/next/etc/config

# Start AeroSpace at login
start-at-login = true

after-startup-command = [
    # JankyBorders has a built-in detection of already running process,
    # so it won't be run twice on AeroSpace restart
    # A color formatted as 0xAARRGGBB, where A is the alpha channel, R the red channel, G the green channel and B the blue channel. All constituents take a base 16 number, i.e. 0-F.
    # Run Sketchybar together with AeroSpace
    # sketchbar has a built-in detection of already running process,
    # so it won't be run twice on AeroSpace restart
    # Catppuccin Mocha: Mauve (active) & Surface 2 (inactive)
    'exec-and-forget borders active_color=0xffcba6f7 inactive_color=0xff585b70 width=8.0',
    'exec-and-forget sketchybar'
]

# Notify Sketchybar about workspace change
exec-on-workspace-change = ['/bin/bash', '-c',
    'sketchybar --trigger aerospace_workspace_change FOCUSED_WORKSPACE=$AEROSPACE_FOCUSED_WORKSPACE'
]

# Normalizations. See: https://nikitabobko.github.io/AeroSpace/guide#normalization
enable-normalization-flatten-containers = true
enable-normalization-opposite-orientation-for-nested-containers = true

accordion-padding = 30

# Possible values: tiles|accordion
default-root-container-layout = 'tiles'

# Possible values: horizontal|vertical|auto
# 'auto' means: wide monitor (anything wider than high) gets horizontal orientation,
#               tall monitor (anything higher than wide) gets vertical orientation
default-root-container-orientation = 'auto'

# Possible values: (qwerty|dvorak)
# See https://nikitabobko.github.io/AeroSpace/guide#key-mapping
key-mapping.preset = 'qwerty'

# Mouse follows focus when focused monitor changes
on-focused-monitor-changed = ['move-mouse monitor-lazy-center']

[gaps]
inner.horizontal = 5
inner.vertical =   5
outer.left =       5
outer.bottom =     5
outer.top =        15
outer.right =      5


[mode.main.binding]

    # Disable "hide application" shortcuts
    cmd-h = [] # Disable "hide application"
    cmd-alt-h = [] # Disable "hide others"

    cmd-left     =   'focus --boundaries-action wrap-around-the-workspace left'
    cmd-down     =   'focus --boundaries-action wrap-around-the-workspace down'
    cmd-up       =   'focus --boundaries-action wrap-around-the-workspace up'
    cmd-right    =   'focus --boundaries-action wrap-around-the-workspace right'

    cmd-shift-left = 'move left'
    cmd-shift-down = 'move down'
    cmd-shift-up = 'move up'
    cmd-shift-right = 'move right'


    cmd-equal = ['resize width +32']
    cmd-minus = ['resize width -32']
    cmd-shift-equal = ['resize height +32']
    cmd-shift-minus = ['resize height -32']

    cmd-j = 'layout tiles horizontal vertical'
    cmd-comma = 'layout accordion horizontal vertical'
    cmd-f = 'fullscreen'

    # =========================================================================
    # WORKSPACE KEYBOARD SHORTCUTS
    # =========================================================================
    # To add more workspaces (e.g., workspace 5-9):
    # 1. Add: cmd-N = 'workspace N'
    # 2. Add: cmd-shift-N = 'move-node-to-workspace N --focus-follows-window'
    # 3. Update cmd-end to point to last workspace
    # 4. Update WORKSPACE_COUNT in sketchybar/items/spaces.lua
    # =========================================================================

    # Switch to workspace
    cmd-1 = 'workspace 1'
    cmd-2 = 'workspace 2'
    cmd-3 = 'workspace 3'
    cmd-4 = 'workspace 4'

    cmd-pageUp = ['workspace prev']
    cmd-pageDown = ['workspace next']

    cmd-home = ['workspace 1']
    cmd-end = ['workspace 4']  # Update this when adding more workspaces

    # Move window to workspace
    cmd-shift-1 = 'move-node-to-workspace 1 --focus-follows-window'
    cmd-shift-2 = 'move-node-to-workspace 2 --focus-follows-window'
    cmd-shift-3 = 'move-node-to-workspace 3 --focus-follows-window'
    cmd-shift-4 = 'move-node-to-workspace 4 --focus-follows-window'

    alt-tab = 'workspace-back-and-forth' 
    # Move current workspace to next monitor (wrap-around)
    cmd-ctrl-right = 'move-workspace-to-monitor --wrap-around next'

    # Move current workspace to previous monitor (wrap-around)
    cmd-ctrl-left = 'move-workspace-to-monitor --wrap-around prev'

    cmd-g = 'mode service'

    alt-shift-c = 'reload-config'

    # Reset view to default split
    cmd-ctrl-alt-shift-d = 'flatten-workspace-tree'

    # Floating window
    cmd-ctrl-alt-shift-f = 'layout floating tiling'

    # Modes
    cmd-ctrl-alt-shift-m = 'mode merge'
    cmd-ctrl-alt-shift-w = 'mode workspace'
    cmd-ctrl-alt-shift-r = 'mode resize'

[mode.service.binding]
    esc = ['reload-config', 'mode main']
    r = ['flatten-workspace-tree', 'mode main'] # reset layout
    f = ['layout floating tiling', 'mode main'] # Toggle between floating and tiling layout
    backspace = ['close-all-windows-but-current', 'mode main']

    # sticky is not yet supported https://github.com/nikitabobko/AeroSpace/issues/2
    #s = ['layout sticky tiling', 'mode main']

    cmd-shift-left = ['join-with left', 'mode main']
    cmd-shift-down = ['join-with down', 'mode main']
    cmd-shift-up = ['join-with up', 'mode main']
    cmd-shift-right = ['join-with right', 'mode main']

    down = 'volume down'
    up = 'volume up'
    shift-down = ['volume set 0', 'mode main']

# Single monitor setup - all workspaces on main monitor
# [workspace-to-monitor-force-assignment]


[mode.merge.binding]
    space = 'mode main'
    esc = 'mode main'

    left = ['join-with left', 'mode main']
    down = ['join-with down', 'mode main']
    up = ['join-with up', 'mode main']
    right = ['join-with right', 'mode main']


[mode.resize.binding]
    space = 'mode main'
    esc = 'mode main'

    left = ['resize width -16']
    down = ['resize height -16']
    up = ['resize height +16']
    right = ['resize width +16']

    shift-left = ['resize width -64']
    shift-down = ['resize height -64']
    shift-up = ['resize height +64']
    shift-right = ['resize width +64']


[mode.workspace.binding]
    space = 'mode main'
    esc = 'mode main'

    left = ['workspace prev', 'move-mouse window-force-center']
    right = ['workspace next', 'move-mouse window-force-center']
    up = ['focus-monitor prev', 'move-mouse window-force-center']
    down = ['focus-monitor next', 'move-mouse window-force-center']
    
    shift-right = ['move-node-to-workspace next --focus-follows-window']
    shift-left = ['move-node-to-workspace prev --focus-follows-window']
    shift-up = ['move-node-to-monitor prev --focus-follows-window']
    shift-down = ['move-node-to-monitor next --focus-follows-window']



#
# Application-specific configurations
#

[[on-window-detected]]
if.app-name-regex-substring = 'Code - Insiders|Cursor|Simulator|Warp|Xcode|Sublime|iTerm|terminal|VSCode'
run = ['layout tiling', 'move-node-to-workspace 3']

[[on-window-detected]]
if.app-id = 'com.google.Chrome'
run = "move-node-to-workspace 1"


[[on-window-detected]]
if.app-name-regex-substring = 'Basecamp'
run = ['layout tiling', 'move-node-to-workspace 6']

[[on-window-detected]]
if.app-name-regex-substring = 'Hey|Mail'
run = ['layout tiling', 'move-node-to-workspace 4']

[[on-window-detected]]
if.app-name-regex-substring = 'Figma|Framer'
run = ['layout tiling', 'move-node-to-workspace 2']

[[on-window-detected]]
if.app-id = 'com.spotify.client'
run = ['layout tiling', 'move-node-to-workspace 5']

[[on-window-detected]]
if.app-id = 'com.hnc.Discord'
run = ['layout tiling', 'move-node-to-workspace 5']

[[on-window-detected]]
if.app-name-regex-substring = 'Obsidian|Notes'
run = ['layout tiling', 'move-node-to-workspace 5']

[[on-window-detected]]
if.app-id = 'com.1password.1password'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.ActivityMonitor'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.AppStore'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.clock'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'com.apple.FaceTime'
run = 'layout floating'

[[on-window-detected]]
if.app-id = 'org.pqrs.Karabiner-Elements.Settings'
run = 'layout floating'